
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Installation &#8212; metadpy 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="shortcut icon" href="_static/logo.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="None">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="#">

  
  
  
  
  
  
  

  
    <img src="_static/logo.svg" class="logo__image only-light" alt="Logo image">
    <img src="_static/logo.svg" class="logo__image only-dark" alt="Logo image">
  
  
    <p class="title logo__title">metadpy</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="references.html">
                        References
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/embodied-computation-group/metadpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/visceral_mind" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/systole/" title="Pypi" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fas fa-box"></i></span>
            <label class="sr-only">Pypi</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="references.html">
                        References
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/embodied-computation-group/metadpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/visceral_mind" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/systole/" title="Pypi" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fas fa-box"></i></span>
            <label class="sr-only">Pypi</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <p><a class="reference external" href="https://github.com/pre-commit/pre-commit"><img alt="pre-commit" src="https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit&amp;logoColor=white" /></a> <a class="reference external" href="https://github.com/LegrandNico/metadpy/blob/master/LICENSE"><img alt="license" src="https://img.shields.io/badge/License-GPL%20v3-blue.svg" /></a> <a class="reference external" href="https://badge.fury.io/py/metadpy"><img alt="pip" src="https://badge.fury.io/py/metadpy.svg" /></a> <a class="reference external" href="https://travis-ci.com/LegandNico/metadpy"><img alt="travis" src="https://travis-ci.com/LegrandNico/metadpy.svg?branch=master" /></a> <a class="reference external" href="https://codecov.io/gh/LegrandNico/metadpy"><img alt="codecov" src="https://codecov.io/gh/LegrandNico/metadpy/branch/master/graph/badge.svg" /></a> <a class="reference external" href="https://github.com/psf/black"><img alt="black" src="https://img.shields.io/badge/code%20style-black-000000.svg" /></a> <a class="reference external" href="http://mypy-lang.org/"><img alt="mypy" src="http://www.mypy-lang.org/static/mypy_badge.svg" /></a></p>
<hr class="docutils" />
<img src="https://github.com/LegrandNico/metadpy/raw/master/docs/source/images/logo.png" align="left" alt="metadpy" height="250" HSPACE=30>
<p><strong>metadpy</strong> is a Python implementation of standard Bayesian models of behavioural metacognition. It is aimed to provide simple yet powerful functions to compute standard indexes and metrics of signal detection theory (SDT) and metacognitive efficiency (meta-d’ and hierarchical meta-d’) [<strong>1</strong>, <strong>2</strong>, <strong>3</strong>]. The only input required is a data frame encoding task performances and confidence ratings at the trial level.</p>
<p><strong>metadpy</strong> is written in Python 3. It uses <a class="reference external" href="https://numpy.org/">Numpy</a>, <a class="reference external" href="https://www.scipy.org/">Scipy</a> and <a class="reference external" href="https://pandas.pydata.org/%3E">Pandas</a> for most of its operation, comprizing meta-d’ estimation using maximum likelihood estimation (MLE). The (Hierarchical) Bayesian modelling is implemented in <a class="reference external" href="https://github.com/aesara-devs/aesara">Aesara</a> (now renamed <a class="reference external" href="https://github.com/pymc-devs/pytensor">PyTensor</a> for versions of <a class="reference external" href="https://docs.pymc.io/%3E">pymc</a> &gt;5.0).</p>
<section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">#</a></h1>
<p>The package can be installed using pip:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>metadpy
</pre></div>
</div>
<p>For most of the operations, the following packages are required:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/">Numpy</a> (&gt;=1.15)</p></li>
<li><p><a class="reference external" href="https://www.scipy.org/">Scipy</a> (&gt;=1.3.0)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/%3E">Pandas</a> (&gt;=0.24)</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/">Matplotlib</a> (&gt;=3.0.2)</p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org/">Seaborn</a> (&gt;=0.9.0)</p></li>
</ul>
<p>Bayesian models will require:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pymc-devs/pytensor">PyTensor</a></p></li>
<li><p><a class="reference external" href="https://docs.pymc.io/%3E">pymc</a> &gt;5.0)</p></li>
</ul>
</section>
<section id="why-metadpy">
<h1>Why metadpy?<a class="headerlink" href="#why-metadpy" title="Permalink to this headline">#</a></h1>
<p>metadpy stands for meta-d’ (meta-d prime) in Python. meta-d’ is a behavioural metric commonly used in consciousness and metacognition research. It is modelled to reflect metacognitive efficiency (i.e the relationship between subjective reports about performances and objective behaviour).</p>
<p>metadpy first aims to be the Python equivalent of the <a class="reference external" href="https://github.com/metacoglab/HMeta-d">hMeta-d toolbox</a> (Matlab and R). It tries to make these models available to a broader open-source ecosystem and to ease their use via cloud computing interfaces. One notable difference is that While the <a class="reference external" href="https://github.com/metacoglab/HMeta-d">hMeta-d toolbox</a> relies on JAGS for the Bayesian modelling of confidence data (see [<strong>4</strong>]) to analyse task performance and confidence ratings, metadpy is built on the top of <a class="reference external" href="https://docs.pymc.io/%3E">pymc</a>, and uses Hamiltonina Monte Carlo methods (NUTS).</p>
<p>For an extensive introduction to metadpy, you can navigate the following notebooks that are Python adaptations of the introduction to the <a class="reference external" href="https://github.com/metacoglab/HMeta-d">hMeta-d toolbox</a> written in Matlab by Olivia Faul for the <a class="reference external" href="https://github.com/metacoglab/HMeta-d/tree/master/CPC_metacog_tutorial">Zurich Computational Psychiatry course</a>.</p>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Notebook</p></th>
<th class="head"><p>Colab</p></th>
<th class="head"><p>nbViewer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Example 1 - Fitting MLE - Subject and group level</p></td>
<td><p><a class="reference external" href="https://colab.research.google.com/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/Example%201%20-%20Fitting%20MLE%20-%20Subject%20and%20group%20level.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
<td><p><a class="reference external" href="https://nbviewer.jupyter.org/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/Example%201%20-%20Fitting%20MLE%20-%20Subject%20and%20group%20level.ipynb"><img alt="View the notebook" src="https://img.shields.io/badge/render-nbviewer-orange.svg" /></a></p></td>
</tr>
<tr class="row-odd"><td><p>Example 2 - Fitting Bayesian - Subject level (pymc)</p></td>
<td><p><a class="reference external" href="https://colab.research.google.com/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/Example%202%20-%20Fitting%20Bayesian%20-%20Subject%20level%20(pymc).ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
<td><p><a class="reference external" href="https://nbviewer.jupyter.org/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/Example%202%20-%20Fitting%20Bayesian%20-%20Subject%20level%20(pymc).ipynb"><img alt="View the notebook" src="https://img.shields.io/badge/render-nbviewer-orange.svg" /></a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="tutorials">
<h2>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">#</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Notebook</p></th>
<th class="head"><p>Colab</p></th>
<th class="head"><p>nbViewer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1. What metacognition looks like?</p></td>
<td><p><a class="reference external" href="https://colab.research.google.com/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/1-What%20metacognition%20looks%20like.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
<td><p><a class="reference external" href="https://nbviewer.jupyter.org/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/1-What%20metacognition%20looks%20like.ipynb"><img alt="View the notebook" src="https://img.shields.io/badge/render-nbviewer-orange.svg" /></a></p></td>
</tr>
<tr class="row-odd"><td><p>2. Fitting the model</p></td>
<td><p><a class="reference external" href="https://colab.research.google.com/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/2-Fitting%20the%20model-MLE.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
<td><p><a class="reference external" href="https://nbviewer.jupyter.org/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/2-Fitting%20the%20model-MLE.ipynb"><img alt="View the notebook" src="https://img.shields.io/badge/render-nbviewer-orange.svg" /></a></p></td>
</tr>
<tr class="row-even"><td><p>3. Comparison with the HMeta-d toolbox</p></td>
<td><p><a class="reference external" href="https://colab.research.google.com/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/3-Comparison%20with%20the%20hmeta-d%20toolbox.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
<td><p><a class="reference external" href="https://nbviewer.jupyter.org/github/embodied-computation-group/metadpy/blob/master/docs/source/examples/3-Comparison%20with%20the%20hmeta-d%20toolbox.ipynb"><img alt="View the notebook" src="https://img.shields.io/badge/render-nbviewer-orange.svg" /></a></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="importing-data">
<h1>Importing data<a class="headerlink" href="#importing-data" title="Permalink to this headline">#</a></h1>
<p>Classical metacognition experiments contain two phases: task performance and confidence ratings. The task performance could for example be the ability to distinguish the presence of a dot on the screen. By relating trials where stimuli are present or absent and the response provided by the participant (Can you see the dot: yes/no), it is possible to obtain the accuracy. The confidence rating is proposed to the participant when the response is made and should reflect how certain the participant is about his/her judgement.</p>
<p>An ideal observer would always associate very high confidence ratings with correct task-I responses, and very low confidence ratings with an incorrect task-1 response, while a participant with a low metacognitive efficiency will have a more mixed response pattern.</p>
<p>A minimal metacognition dataset will therefore consist in a data frame populated with 5 columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Stimuli</span></code>: Which of the two stimuli was presented [0 or 1].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Response</span></code>: The response made by the participant [0 or 1].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Accuracy</span></code>: Was the participant correct? [0 or 1].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Confidence</span></code>: The confidence level [can be continuous or discrete rating].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ntrial</span></code>: The trial number.</p></li>
</ul>
<p>Due to the logical dependence between the <code class="docutils literal notranslate"><span class="pre">Stimuli</span></code>, <code class="docutils literal notranslate"><span class="pre">Responses</span></code> and <code class="docutils literal notranslate"><span class="pre">Accuracy</span></code> columns, in practice only two of those columns are necessary, the third being deduced from the others. Most of the functions in <code class="docutils literal notranslate"><span class="pre">metadpy</span></code> will accept DataFrames containing only two of these columns, and will automatically infer the missing information. Similarly, as the metacognition models described here does not incorporate the temporal dimension, the trial number is optional.</p>
<p><code class="docutils literal notranslate"><span class="pre">metadpy</span></code> includes a simulation function that will let you create one such data frame for one or many participants and condition, controlling for a variety of parameters. Here, we will simulate 200 trials from  participant having <code class="docutils literal notranslate"><span class="pre">d=1</span></code> and <code class="docutils literal notranslate"><span class="pre">c=0</span></code> (task performances) and a <code class="docutils literal notranslate"><span class="pre">meta-d=1.5</span></code> (metacognitive sensibility). The confidence ratings were provided using a 1-to-4 rating scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metadpy.utils</span> <span class="kn">import</span> <span class="n">responseSimulation</span>

<span class="n">simulation</span> <span class="o">=</span> <span class="n">responseSimulation</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nRatings</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nTrials</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stimuli</th>
      <th>Responses</th>
      <th>Accuracy</th>
      <th>Confidence</th>
      <th>nTrial</th>
      <th>Subject</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metadpy.utils</span> <span class="kn">import</span> <span class="n">trials2counts</span>

<span class="n">nR_S1</span><span class="p">,</span> <span class="n">nR_S2</span> <span class="o">=</span> <span class="n">trials2counts</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">simulation</span><span class="p">,</span>
    <span class="n">stimuli</span><span class="o">=</span><span class="s2">&quot;Stimuli&quot;</span><span class="p">,</span>
    <span class="n">accuracy</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
    <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;Confidence&quot;</span><span class="p">,</span>
    <span class="n">nRatings</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nR_S1</span><span class="p">,</span> <span class="n">nR_S2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([625, 410, 389, 305, 466, 185,  90,  30]),
 array([ 25,  86, 210, 450, 294, 389, 389, 657]))
</pre></div>
</div>
</div>
</div>
<section id="data-visualization">
<h2>Data visualization<a class="headerlink" href="#data-visualization" title="Permalink to this headline">#</a></h2>
<p>You can easily visualize metacognition results using one of the plotting functions. Here, we will use the <code class="docutils literal notranslate"><span class="pre">plot_confidence</span></code> and the <code class="docutils literal notranslate"><span class="pre">plot_roc</span></code> functions to visualize the metacognitive performance of our participant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">metadpy.plotting</span> <span class="kn">import</span> <span class="n">plot_confidence</span><span class="p">,</span> <span class="n">plot_roc</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_confidence</span><span class="p">(</span><span class="n">nR_S1</span><span class="p">,</span> <span class="n">nR_S2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_roc</span><span class="p">(</span><span class="n">nR_S1</span><span class="p">,</span> <span class="n">nR_S2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1798e64e5b97ab46ae006a7800b222d090d1dd848547bae64d5aec24f3a72ea2.png" src="_images/1798e64e5b97ab46ae006a7800b222d090d1dd848547bae64d5aec24f3a72ea2.png" />
</div>
</div>
</section>
</section>
<section id="signal-detection-theory-sdt">
<h1>Signal detection theory (SDT)<a class="headerlink" href="#signal-detection-theory-sdt" title="Permalink to this headline">#</a></h1>
<p>All metadpy functions are registred as Pandas flavors (see <a class="reference external" href="https://pypi.org/project/pandas-flavor/">pandas-flavor</a>), which means that the functions can be called as a method from the result data frame. When using the default columns names (<code class="docutils literal notranslate"><span class="pre">Stimuli</span></code>, <code class="docutils literal notranslate"><span class="pre">Response</span></code>, <code class="docutils literal notranslate"><span class="pre">Accuracy</span></code>, <code class="docutils literal notranslate"><span class="pre">Confidence</span></code>), this significantly reduces the length of the function call, making your code more clean and readable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="o">.</span><span class="n">criterion</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="o">.</span><span class="n">dprime</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0007814013683562
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="o">.</span><span class="n">rates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.6916, 0.3084)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="o">.</span><span class="n">roc_auc</span><span class="p">(</span><span class="n">nRatings</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7870479566358235
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="o">.</span><span class="n">scores</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1729, 771, 771, 1729)
</pre></div>
</div>
</div>
</div>
</section>
<section id="estimating-meta-dprime-using-maximum-likelyhood-estimates-mle">
<h1>Estimating meta dprime using Maximum Likelyhood Estimates (MLE)<a class="headerlink" href="#estimating-meta-dprime-using-maximum-likelyhood-estimates-mle" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metadpy.mle</span> <span class="kn">import</span> <span class="n">metad</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">metad</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">simulation</span><span class="p">,</span>
    <span class="n">nRatings</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">stimuli</span><span class="o">=</span><span class="s2">&quot;Stimuli&quot;</span><span class="p">,</span>
    <span class="n">accuracy</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
    <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;Confidence&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dprime</th>
      <th>meta_d</th>
      <th>m_ratio</th>
      <th>m_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.999911</td>
      <td>2.047943</td>
      <td>2.048124</td>
      <td>1.048031</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="estimating-meta-d-using-bayesian-modeling">
<h1>Estimating meta-d’ using Bayesian modeling<a class="headerlink" href="#estimating-meta-d-using-bayesian-modeling" title="Permalink to this headline">#</a></h1>
<section id="subject-level">
<h2>Subject level<a class="headerlink" href="#subject-level" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metadpy.bayesian</span> <span class="kn">import</span> <span class="n">hmetad</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">,</span> <span class="n">trace</span> <span class="o">=</span> <span class="n">hmetad</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">simulation</span><span class="p">,</span>
    <span class="n">nRatings</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">stimuli</span><span class="o">=</span><span class="s2">&quot;Stimuli&quot;</span><span class="p">,</span>
    <span class="n">accuracy</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
    <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;Confidence&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">model</span><span class="p">,</span> <span class="n">trace</span> <span class="o">=</span> <span class="n">hmetad</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">data</span><span class="o">=</span><span class="n">simulation</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">nRatings</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">stimuli</span><span class="o">=</span><span class="s2">&quot;Stimuli&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">accuracy</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;Confidence&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/metadpy/bayesian.py:269,</span> in <span class="ni">hmetad</span><span class="nt">(data, nR_S1, nR_S2, stimuli, accuracy, confidence, nRatings, within, between, subject, nbins, padding, padAmount, sample_model, output, num_samples, num_chains, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">265</span>     <span class="n">pymcData</span> <span class="o">=</span> <span class="n">extractParameters</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">nR_S1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">nR_S2</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span>     <span class="kn">from</span> <span class="nn">subject_level_pymc</span> <span class="kn">import</span> <span class="n">hmetad_subjectLevel</span>
<span class="ne">--&gt; </span><span class="mi">269</span>     <span class="n">model_output</span> <span class="o">=</span> <span class="n">hmetad_subjectLevel</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span>         <span class="n">pymcData</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span>         <span class="n">sample_model</span><span class="o">=</span><span class="n">sample_model</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span>         <span class="n">num_chains</span><span class="o">=</span><span class="n">num_chains</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span>         <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> <span class="c1">#############</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span> <span class="c1"># Group level</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span> <span class="k">elif</span> <span class="p">(</span><span class="n">within</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">between</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subject</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/metadpy/models/subject_level_pymc.py:195,</span> in <span class="ni">hmetad_subjectLevel</span><span class="nt">(data, sample_model, num_samples, num_chains, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span> <span class="n">Multinomial</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span>     <span class="s2">&quot;H_counts&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span>     <span class="n">n</span><span class="o">=</span><span class="n">H</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span>     <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">][</span><span class="n">nRatings</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">nRatings</span> <span class="o">*</span> <span class="mi">4</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span> <span class="k">if</span> <span class="n">sample_model</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">195</span>     <span class="n">trace</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span>         <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span>         <span class="n">chains</span><span class="o">=</span><span class="n">num_chains</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span>         <span class="n">draws</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">199</span>         <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">202</span>     <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">trace</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/sampling/mcmc.py:447,</span> in <span class="ni">sample</span><span class="nt">(draws, step, init, n_init, initvals, trace, chains, cores, tune, progressbar, model, random_seed, discard_tuned_samples, compute_convergence_checks, callback, jitter_max_retries, return_inferencedata, keep_warning_stat, idata_kwargs, mp_ctx, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>         <span class="n">auto_nuts_init</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span> <span class="n">initial_points</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">447</span> <span class="n">step</span> <span class="o">=</span> <span class="n">assign_step_methods</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">STEP_METHODS</span><span class="p">,</span> <span class="n">step_kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">449</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>     <span class="n">step</span> <span class="o">=</span> <span class="n">CompoundStep</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/sampling/mcmc.py:189,</span> in <span class="ni">assign_step_methods</span><span class="nt">(model, step, methods, step_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>         <span class="n">selected</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span>             <span class="n">methods</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>             <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">method</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">rv_var</span><span class="p">,</span> <span class="n">has_gradient</span><span class="o">=</span><span class="n">has_gradient</span><span class="p">:</span> <span class="n">method</span><span class="o">.</span><span class="n">_competence</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span>                 <span class="n">var</span><span class="p">,</span> <span class="n">has_gradient</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>             <span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span>         <span class="n">selected_steps</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">189</span> <span class="k">return</span> <span class="n">instantiate_steppers</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">selected_steps</span><span class="p">,</span> <span class="n">step_kwargs</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/sampling/mcmc.py:107,</span> in <span class="ni">instantiate_steppers</span><span class="nt">(model, steps, selected_steps, step_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span>         <span class="n">args</span> <span class="o">=</span> <span class="n">step_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">step_class</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">{})</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span>         <span class="n">used_keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">step_class</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">107</span>         <span class="n">step</span> <span class="o">=</span> <span class="n">step_class</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="nb">vars</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>         <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span> <span class="n">unused_args</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">step_kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">used_keys</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/step_methods/hmc/nuts.py:182,</span> in <span class="ni">NUTS.__init__</span><span class="nt">(self, vars, max_treedepth, early_max_treedepth, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_treedepth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">early_max_treedepth</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span><span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Set up the No-U-Turn sampler.</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">127</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span><span class="sd">     `pm.sample` to the desired number of tuning steps.</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">182</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span>     <span class="bp">self</span><span class="o">.</span><span class="n">max_treedepth</span> <span class="o">=</span> <span class="n">max_treedepth</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>     <span class="bp">self</span><span class="o">.</span><span class="n">early_max_treedepth</span> <span class="o">=</span> <span class="n">early_max_treedepth</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/step_methods/hmc/base_hmc.py:109,</span> in <span class="ni">BaseHMC.__init__</span><span class="nt">(self, vars, scaling, step_scale, is_cov, model, blocked, potential, dtype, Emax, target_accept, gamma, k, t0, adapt_step_size, step_rand, **pytensor_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="nb">vars</span> <span class="o">=</span> <span class="n">get_value_vars_from_user_vars</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">109</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">blocked</span><span class="o">=</span><span class="n">blocked</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">pytensor_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="bp">self</span><span class="o">.</span><span class="n">adapt_step_size</span> <span class="o">=</span> <span class="n">adapt_step_size</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="bp">self</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="n">Emax</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/step_methods/arraystep.py:263,</span> in <span class="ni">GradientSharedStep.__init__</span><span class="nt">(self, vars, model, blocked, dtype, logp_dlogp_func, **pytensor_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span> <span class="n">model</span> <span class="o">=</span> <span class="n">modelcontext</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span> <span class="k">if</span> <span class="n">logp_dlogp_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">263</span>     <span class="n">func</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">logp_dlogp_function</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">pytensor_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">265</span>     <span class="n">func</span> <span class="o">=</span> <span class="n">logp_dlogp_func</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/model.py:648,</span> in <span class="ni">Model.logp_dlogp_function</span><span class="nt">(self, grad_vars, tempered, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span> <span class="n">ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span> <span class="n">extra_vars_and_values</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">644</span>     <span class="n">var</span><span class="p">:</span> <span class="n">ip</span><span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>     <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_vars</span>
<span class="g g-Whitespace">    </span><span class="mi">646</span>     <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">input_vars</span> <span class="ow">and</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grad_vars</span>
<span class="g g-Whitespace">    </span><span class="mi">647</span> <span class="p">}</span>
<span class="ne">--&gt; </span><span class="mi">648</span> <span class="k">return</span> <span class="n">ValueGradFunction</span><span class="p">(</span><span class="n">costs</span><span class="p">,</span> <span class="n">grad_vars</span><span class="p">,</span> <span class="n">extra_vars_and_values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/model.py:389,</span> in <span class="ni">ValueGradFunction.__init__</span><span class="nt">(self, costs, grad_vars, extra_vars_and_values, dtype, casting, compute_grads, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>     <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cost</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">grad_vars</span>
<span class="ne">--&gt; </span><span class="mi">389</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pytensor_function</span> <span class="o">=</span> <span class="n">compile_pymc</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">givens</span><span class="o">=</span><span class="n">givens</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pymc/pytensorf.py:1121,</span> in <span class="ni">compile_pymc</span><span class="nt">(inputs, outputs, random_seed, mode, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1119</span> <span class="n">opt_qry</span> <span class="o">=</span> <span class="n">mode</span><span class="o">.</span><span class="n">provided_optimizer</span><span class="o">.</span><span class="n">including</span><span class="p">(</span><span class="s2">&quot;random_make_inplace&quot;</span><span class="p">,</span> <span class="n">check_parameter_opt</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1120</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">Mode</span><span class="p">(</span><span class="n">linker</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">linker</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">opt_qry</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1121</span> <span class="n">pytensor_function</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">function</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1122</span>     <span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1123</span>     <span class="n">outputs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1124</span>     <span class="n">updates</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">rng_updates</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;updates&quot;</span><span class="p">,</span> <span class="p">{})},</span>
<span class="g g-Whitespace">   </span><span class="mi">1125</span>     <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1126</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1127</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1128</span> <span class="k">return</span> <span class="n">pytensor_function</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/compile/function/__init__.py:315,</span> in <span class="ni">function</span><span class="nt">(inputs, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>     <span class="n">fn</span> <span class="o">=</span> <span class="n">orig_function</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>         <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">accept_inplace</span><span class="o">=</span><span class="n">accept_inplace</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>     <span class="c1"># note: pfunc will also call orig_function -- orig_function is</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>     <span class="c1">#      a choke point that all compilation must pass through</span>
<span class="ne">--&gt; </span><span class="mi">315</span>     <span class="n">fn</span> <span class="o">=</span> <span class="n">pfunc</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>         <span class="n">params</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span>         <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span>         <span class="n">updates</span><span class="o">=</span><span class="n">updates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>         <span class="n">givens</span><span class="o">=</span><span class="n">givens</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>         <span class="n">no_default_updates</span><span class="o">=</span><span class="n">no_default_updates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>         <span class="n">accept_inplace</span><span class="o">=</span><span class="n">accept_inplace</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>         <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>         <span class="n">rebuild_strict</span><span class="o">=</span><span class="n">rebuild_strict</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>         <span class="n">allow_input_downcast</span><span class="o">=</span><span class="n">allow_input_downcast</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>         <span class="n">on_unused_input</span><span class="o">=</span><span class="n">on_unused_input</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="n">output_keys</span><span class="o">=</span><span class="n">output_keys</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span> <span class="k">return</span> <span class="n">fn</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/compile/function/pfunc.py:367,</span> in <span class="ni">pfunc</span><span class="nt">(params, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input, output_keys, fgraph)</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span>     <span class="n">profile</span> <span class="o">=</span> <span class="n">ProfileStats</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">profile</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">cloned_outputs</span> <span class="o">=</span> <span class="n">construct_pfunc_ins_and_outs</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span>     <span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>     <span class="n">outputs</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span>     <span class="n">fgraph</span><span class="o">=</span><span class="n">fgraph</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">367</span> <span class="k">return</span> <span class="n">orig_function</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">368</span>     <span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span>     <span class="n">cloned_outputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span>     <span class="n">accept_inplace</span><span class="o">=</span><span class="n">accept_inplace</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>     <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span>     <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span>     <span class="n">on_unused_input</span><span class="o">=</span><span class="n">on_unused_input</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span>     <span class="n">output_keys</span><span class="o">=</span><span class="n">output_keys</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>     <span class="n">fgraph</span><span class="o">=</span><span class="n">fgraph</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span> <span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/compile/function/types.py:1766,</span> in <span class="ni">orig_function</span><span class="nt">(inputs, outputs, mode, accept_inplace, name, profile, on_unused_input, output_keys, fgraph)</span>
<span class="g g-Whitespace">   </span><span class="mi">1754</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">Maker</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1755</span>         <span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1756</span>         <span class="n">outputs</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1763</span>         <span class="n">fgraph</span><span class="o">=</span><span class="n">fgraph</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1764</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1765</span>     <span class="k">with</span> <span class="n">config</span><span class="o">.</span><span class="n">change_flags</span><span class="p">(</span><span class="n">compute_test_value</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1766</span>         <span class="n">fn</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1767</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1768</span>     <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/compile/function/types.py:1659,</span> in <span class="ni">FunctionMaker.create</span><span class="nt">(self, input_storage, trustme, storage_map)</span>
<span class="g g-Whitespace">   </span><span class="mi">1656</span> <span class="n">start_import_time</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">cmodule</span><span class="o">.</span><span class="n">import_time</span>
<span class="g g-Whitespace">   </span><span class="mi">1658</span> <span class="k">with</span> <span class="n">config</span><span class="o">.</span><span class="n">change_flags</span><span class="p">(</span><span class="n">traceback__limit</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">traceback__compile_limit</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1659</span>     <span class="n">_fn</span><span class="p">,</span> <span class="n">_i</span><span class="p">,</span> <span class="n">_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linker</span><span class="o">.</span><span class="n">make_thunk</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1660</span>         <span class="n">input_storage</span><span class="o">=</span><span class="n">input_storage_lists</span><span class="p">,</span> <span class="n">storage_map</span><span class="o">=</span><span class="n">storage_map</span>
<span class="g g-Whitespace">   </span><span class="mi">1661</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1663</span> <span class="n">end_linker</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1665</span> <span class="n">linker_time</span> <span class="o">=</span> <span class="n">end_linker</span> <span class="o">-</span> <span class="n">start_linker</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/basic.py:254,</span> in <span class="ni">LocalLinker.make_thunk</span><span class="nt">(self, input_storage, output_storage, storage_map, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span> <span class="k">def</span> <span class="nf">make_thunk</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>     <span class="n">input_storage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;InputStorageType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;BasicThunkType&quot;</span><span class="p">,</span> <span class="s2">&quot;InputStorageType&quot;</span><span class="p">,</span> <span class="s2">&quot;OutputStorageType&quot;</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">254</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_all</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span>         <span class="n">input_storage</span><span class="o">=</span><span class="n">input_storage</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span>         <span class="n">output_storage</span><span class="o">=</span><span class="n">output_storage</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span>         <span class="n">storage_map</span><span class="o">=</span><span class="n">storage_map</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span>     <span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/vm.py:1246,</span> in <span class="ni">VMLinker.make_all</span><span class="nt">(self, profiler, input_storage, output_storage, storage_map)</span>
<span class="g g-Whitespace">   </span><span class="mi">1241</span> <span class="n">thunk_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1242</span> <span class="c1"># no-recycling is done at each VM.__call__ So there is</span>
<span class="g g-Whitespace">   </span><span class="mi">1243</span> <span class="c1"># no need to cause duplicate c code by passing</span>
<span class="g g-Whitespace">   </span><span class="mi">1244</span> <span class="c1"># no_recycling here.</span>
<span class="g g-Whitespace">   </span><span class="mi">1245</span> <span class="n">thunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">1246</span>     <span class="n">node</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">make_thunk</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">storage_map</span><span class="p">,</span> <span class="n">compute_map</span><span class="p">,</span> <span class="p">[],</span> <span class="n">impl</span><span class="o">=</span><span class="n">impl</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1247</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1248</span> <span class="n">linker_make_thunk_time</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">thunk_start</span>
<span class="g g-Whitespace">   </span><span class="mi">1249</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">thunks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;lazy&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1250</span>     <span class="c1"># We don&#39;t want all ops maker to think about lazy Ops.</span>
<span class="g g-Whitespace">   </span><span class="mi">1251</span>     <span class="c1"># So if they didn&#39;t specify that its lazy or not, it isn&#39;t.</span>
<span class="g g-Whitespace">   </span><span class="mi">1252</span>     <span class="c1"># If this member isn&#39;t present, it will crash later.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/op.py:131,</span> in <span class="ni">COp.make_thunk</span><span class="nt">(self, node, storage_map, compute_map, no_recycling, impl)</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_node</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>     <span class="n">node</span><span class="p">,</span> <span class="n">storage_map</span><span class="o">=</span><span class="n">storage_map</span><span class="p">,</span> <span class="n">compute_map</span><span class="o">=</span><span class="n">compute_map</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s2">&quot;c&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">131</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_c_thunk</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">storage_map</span><span class="p">,</span> <span class="n">compute_map</span><span class="p">,</span> <span class="n">no_recycling</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="n">MethodNotDefined</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="c1"># We requested the c code, so don&#39;t catch the error.</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="k">if</span> <span class="n">impl</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/op.py:96,</span> in <span class="ni">COp.make_c_thunk</span><span class="nt">(self, node, storage_map, compute_map, no_recycling)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span>         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disabling C code for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> due to unsupported float16&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;float16&quot;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">96</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">make_thunk</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="n">input_storage</span><span class="o">=</span><span class="n">node_input_storage</span><span class="p">,</span> <span class="n">output_storage</span><span class="o">=</span><span class="n">node_output_storage</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span> <span class="n">thunk</span><span class="p">,</span> <span class="n">node_input_filters</span><span class="p">,</span> <span class="n">node_output_filters</span> <span class="o">=</span> <span class="n">outputs</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> <span class="nd">@is_cthunk_wrapper_type</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span> <span class="k">def</span> <span class="nf">rval</span><span class="p">():</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/basic.py:1202,</span> in <span class="ni">CLinker.make_thunk</span><span class="nt">(self, input_storage, output_storage, storage_map, cache, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1167</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Compile this linker&#39;s `self.fgraph` and return a function that performs the computations.</span>
<span class="g g-Whitespace">   </span><span class="mi">1168</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1169</span><span class="sd"> The return values can be used as follows:</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1199</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1200</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1201</span> <span class="n">init_tasks</span><span class="p">,</span> <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_init_tasks</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1202</span> <span class="n">cthunk</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">in_storage</span><span class="p">,</span> <span class="n">out_storage</span><span class="p">,</span> <span class="n">error_storage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compile__</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1203</span>     <span class="n">input_storage</span><span class="p">,</span> <span class="n">output_storage</span><span class="p">,</span> <span class="n">storage_map</span><span class="p">,</span> <span class="n">cache</span>
<span class="g g-Whitespace">   </span><span class="mi">1204</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1206</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_CThunk</span><span class="p">(</span><span class="n">cthunk</span><span class="p">,</span> <span class="n">init_tasks</span><span class="p">,</span> <span class="n">tasks</span><span class="p">,</span> <span class="n">error_storage</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1207</span> <span class="n">res</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_order</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/basic.py:1122,</span> in <span class="ni">CLinker.__compile__</span><span class="nt">(self, input_storage, output_storage, storage_map, cache)</span>
<span class="g g-Whitespace">   </span><span class="mi">1120</span> <span class="n">input_storage</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">input_storage</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1121</span> <span class="n">output_storage</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">output_storage</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1122</span> <span class="n">thunk</span><span class="p">,</span> <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cthunk_factory</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1123</span>     <span class="n">error_storage</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1124</span>     <span class="n">input_storage</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1125</span>     <span class="n">output_storage</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1126</span>     <span class="n">storage_map</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1127</span>     <span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1128</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1129</span> <span class="k">return</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1130</span>     <span class="n">thunk</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1131</span>     <span class="n">module</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1140</span>     <span class="n">error_storage</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1141</span> <span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/basic.py:1647,</span> in <span class="ni">CLinker.cthunk_factory</span><span class="nt">(self, error_storage, in_storage, out_storage, storage_map, cache)</span>
<span class="g g-Whitespace">   </span><span class="mi">1645</span>     <span class="k">if</span> <span class="n">cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1646</span>         <span class="n">cache</span> <span class="o">=</span> <span class="n">get_module_cache</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1647</span>     <span class="n">module</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">module_from_key</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">lnk</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1649</span> <span class="nb">vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">orphans</span>
<span class="g g-Whitespace">   </span><span class="mi">1650</span> <span class="c1"># List of indices that should be ignored when passing the arguments</span>
<span class="g g-Whitespace">   </span><span class="mi">1651</span> <span class="c1"># (basically, everything that the previous call to uniq eliminated)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/cmodule.py:1231,</span> in <span class="ni">ModuleCache.module_from_key</span><span class="nt">(self, key, lnk)</span>
<span class="g g-Whitespace">   </span><span class="mi">1229</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1230</span>     <span class="n">location</span> <span class="o">=</span> <span class="n">dlimport_workdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1231</span>     <span class="n">module</span> <span class="o">=</span> <span class="n">lnk</span><span class="o">.</span><span class="n">compile_cmodule</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1232</span>     <span class="n">name</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="vm">__file__</span>
<span class="g g-Whitespace">   </span><span class="mi">1233</span>     <span class="k">assert</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/basic.py:1546,</span> in <span class="ni">CLinker.compile_cmodule</span><span class="nt">(self, location)</span>
<span class="g g-Whitespace">   </span><span class="mi">1544</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1545</span>     <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LOCATION </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1546</span>     <span class="n">module</span> <span class="o">=</span> <span class="n">c_compiler</span><span class="o">.</span><span class="n">compile_str</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1547</span>         <span class="n">module_name</span><span class="o">=</span><span class="n">mod</span><span class="o">.</span><span class="n">code_hash</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1548</span>         <span class="n">src_code</span><span class="o">=</span><span class="n">src_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1549</span>         <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1550</span>         <span class="n">include_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">header_dirs</span><span class="p">(),</span>
<span class="g g-Whitespace">   </span><span class="mi">1551</span>         <span class="n">lib_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_dirs</span><span class="p">(),</span>
<span class="g g-Whitespace">   </span><span class="mi">1552</span>         <span class="n">libs</span><span class="o">=</span><span class="n">libs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1553</span>         <span class="n">preargs</span><span class="o">=</span><span class="n">preargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1554</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1555</span> <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1556</span>     <span class="n">e</span><span class="o">.</span><span class="n">args</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fgraph</span><span class="p">),)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/link/c/cmodule.py:2591,</span> in <span class="ni">GCC_compiler.compile_str</span><span class="nt">(module_name, src_code, location, include_dirs, lib_dirs, libs, preargs, py_module, hide_symbols)</span>
<span class="g g-Whitespace">   </span><span class="mi">2588</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2590</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2591</span>     <span class="n">p_out</span> <span class="o">=</span> <span class="n">output_subprocess_Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2592</span>     <span class="n">compile_stderr</span> <span class="o">=</span> <span class="n">p_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2593</span> <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2594</span>     <span class="c1"># An exception can occur e.g. if `g++` is not found.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/pytensor/utils.py:261,</span> in <span class="ni">output_subprocess_Popen</span><span class="nt">(command, **params)</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span> <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess_Popen</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span> <span class="c1"># we need to use communicate to make sure we don&#39;t deadlock around</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span> <span class="c1"># the stdout/stderr pipe.</span>
<span class="ne">--&gt; </span><span class="mi">261</span> <span class="n">out</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span> <span class="k">return</span> <span class="n">out</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">returncode</span><span class="p">,)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/subprocess.py:1134,</span> in <span class="ni">Popen.communicate</span><span class="nt">(self, input, timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1131</span>     <span class="n">endtime</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1133</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1134</span>     <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_communicate</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1135</span> <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1136</span>     <span class="c1"># https://bugs.python.org/issue25942</span>
<span class="g g-Whitespace">   </span><span class="mi">1137</span>     <span class="c1"># See the detailed comment in .wait().</span>
<span class="g g-Whitespace">   </span><span class="mi">1138</span>     <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/subprocess.py:1979,</span> in <span class="ni">Popen._communicate</span><span class="nt">(self, input, endtime, orig_timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1972</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_timeout</span><span class="p">(</span><span class="n">endtime</span><span class="p">,</span> <span class="n">orig_timeout</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1973</span>                         <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1974</span>                         <span class="n">skip_check_and_raise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1975</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>  <span class="c1"># Impossible :)</span>
<span class="g g-Whitespace">   </span><span class="mi">1976</span>         <span class="s1">&#39;_check_timeout(..., skip_check_and_raise=True) &#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">1977</span>         <span class="s1">&#39;failed to raise TimeoutExpired.&#39;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1979</span> <span class="n">ready</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1980</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_timeout</span><span class="p">(</span><span class="n">endtime</span><span class="p">,</span> <span class="n">orig_timeout</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1982</span> <span class="c1"># XXX Rewrite these to use non-blocking I/O on the file</span>
<span class="g g-Whitespace">   </span><span class="mi">1983</span> <span class="c1"># objects; they are no longer using C stdio!</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/selectors.py:416,</span> in <span class="ni">_PollLikeSelector.select</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span> <span class="n">ready</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">416</span>     <span class="n">fd_event_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selector</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span> <span class="k">except</span> <span class="ne">InterruptedError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span>     <span class="k">return</span> <span class="n">ready</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;meta_d&quot;</span><span class="p">,</span> <span class="s2">&quot;cS2&quot;</span><span class="p">,</span> <span class="s2">&quot;cS1&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;meta_d&quot;</span><span class="p">,</span> <span class="s2">&quot;cS2&quot;</span><span class="p">,</span> <span class="s2">&quot;cS1&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><img src = "https://raw.githubusercontent.com/embodied-computation-group/metadpy/master/docs/source/images/LabLogo.png" height ="100"><img src = "https://raw.githubusercontent.com/embodied-computation-group/metadpy/master/docs/source/images/AU.png" height ="100"></p>
<div class="toctree-wrapper compound">
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='right-next' id="next-link" href="api.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">API</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Installation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-metadpy">
   Why metadpy?
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples">
     Examples
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tutorials">
     Tutorials
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-data">
   Importing data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-visualization">
     Data visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#signal-detection-theory-sdt">
   Signal detection theory (SDT)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-meta-dprime-using-maximum-likelyhood-estimates-mle">
   Estimating meta dprime using Maximum Likelyhood Estimates (MLE)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-meta-d-using-bayesian-modeling">
   Estimating meta-d’ using Bayesian modeling
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subject-level">
     Subject level
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/index.md.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022-2023, Nicolas Legrand.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>