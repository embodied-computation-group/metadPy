Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
fitLowNoise = fit_metad(low_noise_nR_S1, low_noise_nR_S2, nRatings=nRatings)
fitHighNoise = fit_metad(high_noise_nR_S1, high_noise_nR_S2, nRatings=nRatings)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[10], line 2[0m
[1;32m      1[0m fitLowNoise [38;5;241m=[39m fit_metad(low_noise_nR_S1, low_noise_nR_S2, nRatings[38;5;241m=[39mnRatings)
[0;32m----> 2[0m fitHighNoise [38;5;241m=[39m [43mfit_metad[49m[43m([49m[43mhigh_noise_nR_S1[49m[43m,[49m[43m [49m[43mhigh_noise_nR_S2[49m[43m,[49m[43m [49m[43mnRatings[49m[38;5;241;43m=[39;49m[43mnRatings[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/metadpy/mle.py:753[0m, in [0;36mfit_metad[0;34m(nR_S1, nR_S2, nRatings, nCriteria, s, verbose, fninv, fncdf)[0m
[1;32m    750[0m linear_constraint [38;5;241m=[39m LinearConstraint(A, lb, ub)
[1;32m    752[0m [38;5;66;03m# minimization of negative log-likelihood[39;00m
[0;32m--> 753[0m results [38;5;241m=[39m [43mminimize[49m[43m([49m
[1;32m    754[0m [43m    [49m[43mfit_meta_d_logL[49m[43m,[49m
[1;32m    755[0m [43m    [49m[43mguess[49m[43m,[49m
[1;32m    756[0m [43m    [49m[43margs[49m[38;5;241;43m=[39;49m[43m([49m[43mnR_S1[49m[43m,[49m[43m [49m[43mnR_S2[49m[43m,[49m[43m [49m[43mnRatings[49m[43m,[49m[43m [49m[43md1[49m[43m,[49m[43m [49m[43mt1c1[49m[43m,[49m[43m [49m[43ms[49m[43m)[49m[43m,[49m
[1;32m    757[0m [43m    [49m[43mmethod[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mtrust-constr[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m    758[0m [43m    [49m[43mjac[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43m2-point[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m    759[0m [43m    [49m[43mhess[49m[38;5;241;43m=[39;49m[43mSR1[49m[43m([49m[43m)[49m[43m,[49m
[1;32m    760[0m [43m    [49m[43mconstraints[49m[38;5;241;43m=[39;49m[43m[[49m[43mlinear_constraint[49m[43m][49m[43m,[49m
[1;32m    761[0m [43m    [49m[43moptions[49m[38;5;241;43m=[39;49m[43m{[49m[38;5;124;43m"[39;49m[38;5;124;43mverbose[39;49m[38;5;124;43m"[39;49m[43m:[49m[43m [49m[43mverbose[49m[43m}[49m[43m,[49m
[1;32m    762[0m [43m    [49m[43mbounds[49m[38;5;241;43m=[39;49m[43mbounds[49m[43m,[49m
[1;32m    763[0m [43m[49m[43m)[49m
[1;32m    765[0m [38;5;66;03m# quickly process some of the output[39;00m
[1;32m    766[0m meta_d1 [38;5;241m=[39m results[38;5;241m.[39mx[[38;5;241m0[39m]

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/optimize/_minimize.py:708[0m, in [0;36mminimize[0;34m(fun, x0, args, method, jac, hess, hessp, bounds, constraints, tol, callback, options)[0m
[1;32m    705[0m     res [38;5;241m=[39m _minimize_slsqp(fun, x0, args, jac, bounds,
[1;32m    706[0m                           constraints, callback[38;5;241m=[39mcallback, [38;5;241m*[39m[38;5;241m*[39moptions)
[1;32m    707[0m [38;5;28;01melif[39;00m meth [38;5;241m==[39m [38;5;124m'[39m[38;5;124mtrust-constr[39m[38;5;124m'[39m:
[0;32m--> 708[0m     res [38;5;241m=[39m [43m_minimize_trustregion_constr[49m[43m([49m[43mfun[49m[43m,[49m[43m [49m[43mx0[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mjac[49m[43m,[49m[43m [49m[43mhess[49m[43m,[49m[43m [49m[43mhessp[49m[43m,[49m
[1;32m    709[0m [43m                                       [49m[43mbounds[49m[43m,[49m[43m [49m[43mconstraints[49m[43m,[49m
[1;32m    710[0m [43m                                       [49m[43mcallback[49m[38;5;241;43m=[39;49m[43mcallback[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43moptions[49m[43m)[49m
[1;32m    711[0m [38;5;28;01melif[39;00m meth [38;5;241m==[39m [38;5;124m'[39m[38;5;124mdogleg[39m[38;5;124m'[39m:
[1;32m    712[0m     res [38;5;241m=[39m _minimize_dogleg(fun, x0, args, jac, hess,
[1;32m    713[0m                            callback[38;5;241m=[39mcallback, [38;5;241m*[39m[38;5;241m*[39moptions)

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/optimize/_trustregion_constr/minimize_trustregion_constr.py:509[0m, in [0;36m_minimize_trustregion_constr[0;34m(fun, x0, args, grad, hess, hessp, bounds, constraints, xtol, gtol, barrier_tol, sparse_jacobian, callback, maxiter, verbose, finite_diff_rel_step, initial_constr_penalty, initial_tr_radius, initial_barrier_parameter, initial_barrier_tolerance, factorization_method, disp)[0m
[1;32m    500[0m     _, result [38;5;241m=[39m equality_constrained_sqp(
[1;32m    501[0m         fun_and_constr, grad_and_jac, lagrangian_hess,
[1;32m    502[0m         x0, objective[38;5;241m.[39mf, objective[38;5;241m.[39mg,
[0;32m   (...)[0m
[1;32m    505[0m         initial_constr_penalty, initial_tr_radius,
[1;32m    506[0m         factorization_method)
[1;32m    508[0m [38;5;28;01melif[39;00m method [38;5;241m==[39m [38;5;124m'[39m[38;5;124mtr_interior_point[39m[38;5;124m'[39m:
[0;32m--> 509[0m     _, result [38;5;241m=[39m [43mtr_interior_point[49m[43m([49m
[1;32m    510[0m [43m        [49m[43mobjective[49m[38;5;241;43m.[39;49m[43mfun[49m[43m,[49m[43m [49m[43mobjective[49m[38;5;241;43m.[39;49m[43mgrad[49m[43m,[49m[43m [49m[43mlagrangian_hess[49m[43m,[49m
[1;32m    511[0m [43m        [49m[43mn_vars[49m[43m,[49m[43m [49m[43mcanonical[49m[38;5;241;43m.[39;49m[43mn_ineq[49m[43m,[49m[43m [49m[43mcanonical[49m[38;5;241;43m.[39;49m[43mn_eq[49m[43m,[49m
[1;32m    512[0m [43m        [49m[43mcanonical[49m[38;5;241;43m.[39;49m[43mfun[49m[43m,[49m[43m [49m[43mcanonical[49m[38;5;241;43m.[39;49m[43mjac[49m[43m,[49m
[1;32m    513[0m [43m        [49m[43mx0[49m[43m,[49m[43m [49m[43mobjective[49m[38;5;241;43m.[39;49m[43mf[49m[43m,[49m[43m [49m[43mobjective[49m[38;5;241;43m.[39;49m[43mg[49m[43m,[49m
[1;32m    514[0m [43m        [49m[43mc_ineq0[49m[43m,[49m[43m [49m[43mJ_ineq0[49m[43m,[49m[43m [49m[43mc_eq0[49m[43m,[49m[43m [49m[43mJ_eq0[49m[43m,[49m
[1;32m    515[0m [43m        [49m[43mstop_criteria[49m[43m,[49m
[1;32m    516[0m [43m        [49m[43mcanonical[49m[38;5;241;43m.[39;49m[43mkeep_feasible[49m[43m,[49m
[1;32m    517[0m [43m        [49m[43mxtol[49m[43m,[49m[43m [49m[43mstate[49m[43m,[49m[43m [49m[43minitial_barrier_parameter[49m[43m,[49m
[1;32m    518[0m [43m        [49m[43minitial_barrier_tolerance[49m[43m,[49m
[1;32m    519[0m [43m        [49m[43minitial_constr_penalty[49m[43m,[49m[43m [49m[43minitial_tr_radius[49m[43m,[49m
[1;32m    520[0m [43m        [49m[43mfactorization_method[49m[43m)[49m
[1;32m    522[0m [38;5;66;03m# Status 3 occurs when the callback function requests termination,[39;00m
[1;32m    523[0m [38;5;66;03m# this is assumed to not be a success.[39;00m
[1;32m    524[0m result[38;5;241m.[39msuccess [38;5;241m=[39m [38;5;28;01mTrue[39;00m [38;5;28;01mif[39;00m result[38;5;241m.[39mstatus [38;5;129;01min[39;00m ([38;5;241m1[39m, [38;5;241m2[39m) [38;5;28;01melse[39;00m [38;5;28;01mFalse[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/optimize/_trustregion_constr/tr_interior_point.py:321[0m, in [0;36mtr_interior_point[0;34m(fun, grad, lagr_hess, n_vars, n_ineq, n_eq, constr, jac, x0, fun0, grad0, constr_ineq0, jac_ineq0, constr_eq0, jac_eq0, stop_criteria, enforce_feasibility, xtol, state, initial_barrier_parameter, initial_tolerance, initial_penalty, initial_trust_radius, factorization_method)[0m
[1;32m    318[0m [38;5;66;03m# Solves a sequence of barrier problems[39;00m
[1;32m    319[0m [38;5;28;01mwhile[39;00m [38;5;28;01mTrue[39;00m:
[1;32m    320[0m     [38;5;66;03m# Solve SQP subproblem[39;00m
[0;32m--> 321[0m     z, state [38;5;241m=[39m [43mequality_constrained_sqp[49m[43m([49m
[1;32m    322[0m [43m        [49m[43msubprob[49m[38;5;241;43m.[39;49m[43mfunction_and_constraints[49m[43m,[49m
[1;32m    323[0m [43m        [49m[43msubprob[49m[38;5;241;43m.[39;49m[43mgradient_and_jacobian[49m[43m,[49m
[1;32m    324[0m [43m        [49m[43msubprob[49m[38;5;241;43m.[39;49m[43mlagrangian_hessian[49m[43m,[49m
[1;32m    325[0m [43m        [49m[43mz[49m[43m,[49m[43m [49m[43mfun0_subprob[49m[43m,[49m[43m [49m[43mgrad0_subprob[49m[43m,[49m
[1;32m    326[0m [43m        [49m[43mconstr0_subprob[49m[43m,[49m[43m [49m[43mjac0_subprob[49m[43m,[49m[43m [49m[43msubprob[49m[38;5;241;43m.[39;49m[43mstop_criteria[49m[43m,[49m
[1;32m    327[0m [43m        [49m[43mstate[49m[43m,[49m[43m [49m[43minitial_penalty[49m[43m,[49m[43m [49m[43mtrust_radius[49m[43m,[49m
[1;32m    328[0m [43m        [49m[43mfactorization_method[49m[43m,[49m[43m [49m[43mtrust_lb[49m[43m,[49m[43m [49m[43mtrust_ub[49m[43m,[49m[43m [49m[43msubprob[49m[38;5;241;43m.[39;49m[43mscaling[49m[43m)[49m
[1;32m    329[0m     [38;5;28;01mif[39;00m subprob[38;5;241m.[39mterminate:
[1;32m    330[0m         [38;5;28;01mbreak[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/optimize/_trustregion_constr/equality_constrained_sqp.py:80[0m, in [0;36mequality_constrained_sqp[0;34m(fun_and_constr, grad_and_jac, lagr_hess, x0, fun0, grad0, constr0, jac0, stop_criteria, state, initial_penalty, initial_trust_radius, factorization_method, trust_lb, trust_ub, scaling)[0m
[1;32m     78[0m S [38;5;241m=[39m scaling(x)
[1;32m     79[0m [38;5;66;03m# Get projections[39;00m
[0;32m---> 80[0m Z, LS, Y [38;5;241m=[39m [43mprojections[49m[43m([49m[43mA[49m[43m,[49m[43m [49m[43mfactorization_method[49m[43m)[49m
[1;32m     81[0m [38;5;66;03m# Compute least-square lagrange multipliers[39;00m
[1;32m     82[0m v [38;5;241m=[39m [38;5;241m-[39mLS[38;5;241m.[39mdot(c)

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/optimize/_trustregion_constr/projections.py:396[0m, in [0;36mprojections[0;34m(A, method, orth_tol, max_refin, tol)[0m
[1;32m    392[0m     null_space, least_squares, row_space \
[1;32m    393[0m         [38;5;241m=[39m augmented_system_projections(A, m, n, orth_tol, max_refin, tol)
[1;32m    394[0m [38;5;28;01melif[39;00m method [38;5;241m==[39m [38;5;124m"[39m[38;5;124mQRFactorization[39m[38;5;124m"[39m:
[1;32m    395[0m     null_space, least_squares, row_space \
[0;32m--> 396[0m         [38;5;241m=[39m [43mqr_factorization_projections[49m[43m([49m[43mA[49m[43m,[49m[43m [49m[43mm[49m[43m,[49m[43m [49m[43mn[49m[43m,[49m[43m [49m[43morth_tol[49m[43m,[49m[43m [49m[43mmax_refin[49m[43m,[49m[43m [49m[43mtol[49m[43m)[49m
[1;32m    397[0m [38;5;28;01melif[39;00m method [38;5;241m==[39m [38;5;124m"[39m[38;5;124mSVDFactorization[39m[38;5;124m"[39m:
[1;32m    398[0m     null_space, least_squares, row_space \
[1;32m    399[0m         [38;5;241m=[39m svd_factorization_projections(A, m, n, orth_tol, max_refin, tol)

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/optimize/_trustregion_constr/projections.py:178[0m, in [0;36mqr_factorization_projections[0;34m(A, m, n, orth_tol, max_refin, tol)[0m
[1;32m    175[0m [38;5;250m[39m[38;5;124;03m"""Return linear operators for matrix A using ``QRFactorization`` approach.[39;00m
[1;32m    176[0m [38;5;124;03m"""[39;00m
[1;32m    177[0m [38;5;66;03m# QRFactorization[39;00m
[0;32m--> 178[0m Q, R, P [38;5;241m=[39m [43mscipy[49m[38;5;241;43m.[39;49m[43mlinalg[49m[38;5;241;43m.[39;49m[43mqr[49m[43m([49m[43mA[49m[38;5;241;43m.[39;49m[43mT[49m[43m,[49m[43m [49m[43mpivoting[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m[43m [49m[43mmode[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43meconomic[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m    180[0m [38;5;28;01mif[39;00m np[38;5;241m.[39mlinalg[38;5;241m.[39mnorm(R[[38;5;241m-[39m[38;5;241m1[39m, :], np[38;5;241m.[39minf) [38;5;241m<[39m tol:
[1;32m    181[0m     warn([38;5;124m'[39m[38;5;124mSingular Jacobian matrix. Using SVD decomposition to [39m[38;5;124m'[39m [38;5;241m+[39m
[1;32m    182[0m          [38;5;124m'[39m[38;5;124mperform the factorizations.[39m[38;5;124m'[39m)

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/scipy/linalg/_decomp_qr.py:128[0m, in [0;36mqr[0;34m(a, overwrite_a, lwork, mode, pivoting, check_finite)[0m
[1;32m    124[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m"[39m[38;5;124mMode argument should be one of [[39m[38;5;124m'[39m[38;5;124mfull[39m[38;5;124m'[39m[38;5;124m, [39m[38;5;124m'[39m[38;5;124mr[39m[38;5;124m'[39m[38;5;124m,[39m[38;5;124m"[39m
[1;32m    125[0m                      [38;5;124m"[39m[38;5;124m'[39m[38;5;124meconomic[39m[38;5;124m'[39m[38;5;124m, [39m[38;5;124m'[39m[38;5;124mraw[39m[38;5;124m'[39m[38;5;124m][39m[38;5;124m"[39m)
[1;32m    127[0m [38;5;28;01mif[39;00m check_finite:
[0;32m--> 128[0m     a1 [38;5;241m=[39m [43mnumpy[49m[38;5;241;43m.[39;49m[43masarray_chkfinite[49m[43m([49m[43ma[49m[43m)[49m
[1;32m    129[0m [38;5;28;01melse[39;00m:
[1;32m    130[0m     a1 [38;5;241m=[39m numpy[38;5;241m.[39masarray(a)

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/numpy/lib/function_base.py:627[0m, in [0;36masarray_chkfinite[0;34m(a, dtype, order)[0m
[1;32m    625[0m a [38;5;241m=[39m asarray(a, dtype[38;5;241m=[39mdtype, order[38;5;241m=[39morder)
[1;32m    626[0m [38;5;28;01mif[39;00m a[38;5;241m.[39mdtype[38;5;241m.[39mchar [38;5;129;01min[39;00m typecodes[[38;5;124m'[39m[38;5;124mAllFloat[39m[38;5;124m'[39m] [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m np[38;5;241m.[39misfinite(a)[38;5;241m.[39mall():
[0;32m--> 627[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[1;32m    628[0m         [38;5;124m"[39m[38;5;124marray must not contain infs or NaNs[39m[38;5;124m"[39m)
[1;32m    629[0m [38;5;28;01mreturn[39;00m a

[0;31mValueError[0m: array must not contain infs or NaNs
ValueError: array must not contain infs or NaNs

